angular.module("wechatController",["service"]).controller("searchWechatCtrl",["$scope","$timeout","$state","$modal","ctx","SubscribeRest","WechatRest",function(b,e,d,c,a,h,g){b.$emit("hideItem");b.$emit("hideSearch");b.$emit("hideSlider");b.$emit("setHeaderTitle","查询公众号");b.showResult="non-display";b.last=true;b.pageNo=1;b.search=function(){b.pageNo=1;f(b.pageNo)};function f(i){var j={name:b.keyword,pageNo:i};g.customGET("searchWechat",j).then(function(k){b.showResult="";b.last=k.obj.last;if(b.pageNo>1){b.wechats=b.wechats.concat(k.obj.wechatModel)}else{b.wechats=k.obj.wechatModel}})}b.loadMore=function(){b.pageNo=b.pageNo+1;f(b.typeid,b.pageNo)};b.wechatDetail=function(i){d.go("wechatDetail",{wechatId:i})};b.toSearchFromInternet=function(){d.go("searchWechatFromInternet",{name:b.keyword})};b.operateSubscribe=function(i,l,k,m){m.stopPropagation();var j={wechatId:i};if(l){h.customGET("unsubscribe",j).then(function(n){b.wechats[k].sub=false})}else{h.customGET("subscribe",j).then(function(n){b.wechats[k].sub=true})}};b.getBtnClass=function(i){return{"btn":true,"pull-right":true,"bg-success":!i,"btn-danger":i}};b.getIconClass=function(i){return{"fa":true,"fa-plus":!i,"fa-minus":i}}}]).controller("searchWechatFromInternetCtrl",["$scope","$stateParams","$timeout","$state","$modal","ctx","SubscribeRest","WechatRest",function(b,f,e,d,c,a,h,g){b.$emit("hideItem");b.$emit("hideSearch");b.$emit("hideSlider");b.$emit("setHeaderTitle","搜索公众号");b.keyword=f.name;b.search=function(){var i={name:b.keyword};g.customGET("searchWechatFromInternet",i).then(function(j){b.wechats=j.obj})};b.wechatDetail=function(i){d.go("wechatDetail",{wechatId:i})};b.operateSubscribe=function(m,k,j,l){l.stopPropagation();if(k){h.customGET("unsubscribe",i).then(function(n){b.wechats[j].sub=false})}else{var i={openId:m};h.customGET("subscribeNewWechat",i).then(function(n){b.wechats[j].sub=true})}};b.getBtnClass=function(i){return{"btn":true,"pull-right":true,"bg-success":!i,"btn-danger":i}};b.getIconClass=function(i){return{"fa":true,"fa-plus":!i,"fa-minus":i}}}]).controller("wechatDetailCtrl",["$scope","$stateParams","$timeout","$state","$modal","ctx","SubscribeRest","WechatRest","ArticleRest",function(i,g,c,a,h,j,b,d,e){i.$emit("hideItem");i.$emit("hideSearch");i.$emit("hideSlider");d.customGET("wechatDetail",{id:g.wechatId}).then(function(k){i.wechat=k.obj});i.pageNo=1;f(g.wechatId,i.pageNo);function f(l,k){e.customGET("getWechatArticles",{wechatId:l,pageNo:k}).then(function(m){i.last=m.obj.last;if(i.pageNo>1){i.articles=i.articles.concat(m.obj.content)}else{i.articles=m.obj.content}})}i.loadMore=function(){i.pageNo=i.pageNo+1;console.log(g.wechatId+"   "+i.pageNo);f(g.wechatId,i.pageNo)};i.operateSubscribe=function(k,m){var l={wechatId:k};if(m){b.customGET("unsubscribe",l).then(function(n){i.wechat.sub=false})}else{b.customGET("subscribe",l).then(function(n){i.wechat.sub=true})}};i.getBtnClass=function(k){return{"btn":true,"pull-right":true,"bg-success":!k,"btn-danger":k}};i.getIconClass=function(k){return{"fa":true,"fa-plus":!k,"fa-minus":k}}}]);